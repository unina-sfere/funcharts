<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Function-on-function linear regression based on principal components — fof_pc • funcharts</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Function-on-function linear regression based on principal components — fof_pc" />
<meta property="og:description" content="Function-on-function linear regression based on
principal components.
This function performs multivariate functional principal component analysis
(MFPCA)
to extract multivariate functional principal components
from the multivariate functional covariates as well as from the
functional response, then it builds a linear regression model
of the response scores on the
covariate scores.
Both functional covariates and response are standardized before
the regression.
See Centofanti et al. (2020) for additional details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funcharts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/capezza2020.html">capezza2020</a>
    </li>
    <li>
      <a href="../articles/centofanti2020.html">centofanti2020</a>
    </li>
    <li>
      <a href="../articles/mfd.html">mfd</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/unina-sfere/funcharts/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function-on-function linear regression based on principal components</h1>
    <small class="dont-index">Source: <a href='https://github.com/unina-sfere/funcharts/blob/master/R/02_fof_pc.R'><code>R/02_fof_pc.R</code></a></small>
    <div class="hidden name"><code>fof_pc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function-on-function linear regression based on
principal components.
This function performs multivariate functional principal component analysis
(MFPCA)
to extract multivariate functional principal components
from the multivariate functional covariates as well as from the
functional response, then it builds a linear regression model
of the response scores on the
covariate scores.
Both functional covariates and response are standardized before
the regression.
See Centofanti et al. (2020) for additional details.</p>
    </div>

    <pre class="usage"><span class='fu'>fof_pc</span><span class='op'>(</span>
  <span class='va'>mfdobj_y</span>,
  <span class='va'>mfdobj_x</span>,
  tot_variance_explained_x <span class='op'>=</span> <span class='fl'>0.95</span>,
  tot_variance_explained_y <span class='op'>=</span> <span class='fl'>0.95</span>,
  tot_variance_explained_res <span class='op'>=</span> <span class='fl'>0.95</span>,
  components_x <span class='op'>=</span> <span class='cn'>NULL</span>,
  components_y <span class='op'>=</span> <span class='cn'>NULL</span>,
  type_residuals <span class='op'>=</span> <span class='st'>"standard"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mfdobj_y</th>
      <td><p>A multivariate functional data object of class
mfd denoting the functional response variable.
Although it is a multivariate functional data object, it must
have only one functional variable.</p></td>
    </tr>
    <tr>
      <th>mfdobj_x</th>
      <td><p>A multivariate functional data object of class
mfd denoting the functional covariates.</p></td>
    </tr>
    <tr>
      <th>tot_variance_explained_x</th>
      <td><p>The minimum fraction of variance
that has to be explained
by the multivariate functional principal components retained into
the MFPCA model fitted on the functional covariates.
Default is 0.95.</p></td>
    </tr>
    <tr>
      <th>tot_variance_explained_y</th>
      <td><p>The minimum fraction of variance that
has to be explained
by the multivariate functional principal components retained into
the MFPCA model fitted on the functional response.
Default is 0.95.</p></td>
    </tr>
    <tr>
      <th>tot_variance_explained_res</th>
      <td><p>The minimum fraction of variance
that has to be explained
by the multivariate functional principal components retained into
the MFPCA model fitted on the functional residuals
of the functional regression model.
Default is 0.95.</p></td>
    </tr>
    <tr>
      <th>components_x</th>
      <td><p>A vector of integers with the components over which
to project the functional covariates.
If NULL, the first components that explain a minimum fraction of variance
equal to <code>tot_variance_explained_x</code>
is selected.
#' If this is not NULL, the criteria to select components are ignored.
Default is NULL.</p></td>
    </tr>
    <tr>
      <th>components_y</th>
      <td><p>A vector of integers with the components over which
to project the functional response.
If NULL, the first components that explain a minimum fraction of variance
equal to <code>tot_variance_explained_y</code>
is selected.
#' If this is not NULL, the criteria to select components are ignored.
Default is NULL.</p></td>
    </tr>
    <tr>
      <th>type_residuals</th>
      <td><p>A character value that can be
"standard" or "studentized".
If "standard", the MFPCA on functional residuals calculated on
the standardized covariates and response.
If "studentized", the MFPCA on studentized version of
the functional residuals calculated on the
non-standardized covariates and response.
See Centofanti et al. (2020) for additional details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing the following arguments:</p>
<p>* <code>mod</code>: an object of class <code>lm</code> that is a linear regression model
where
the response variables are the MFPCA scores of the response variable and
the covariates are the MFPCA scores of the functional covariates.
<code>mod$coefficients</code> contains the matrix of coefficients
of the functional regression basis functions,</p>
<p>* <code>beta_fd</code>: a <code>bi_fd</code> object containing the
bivariate functional regression coefficients \(\beta(s,t)\)
estimated with the function-on-function linear regression model,</p>
<p>* <code>fitted.values</code>: a multivariate functional data object of
class mfd with the fitted values of the
functional response observations based on the
function-on-function linear regression model,</p>
<p>* <code>residuals_original_scale</code>: a multivariate functional data object
of class mfd
with the functional residuals of the
function-on-function linear regression model on the original scale,
i.e. they are the difference between
<code>mfdobj_y</code> and <code>fitted.values</code>,</p>
<p>* <code>residuals</code>: a multivariate functional data object of class mfd
with the functional residuals of the
function-on-function linear regression model,
standardized or studentized depending on
the argument <code>type_residuals</code>,</p>
<p>* <code>type_residuals</code>: the same as the provided argument,</p>
<p>* <code>pca_x</code>: an object of class <code>pca_mfd</code>
obtained by doing MFPCA on the functional covariates,</p>
<p>* <code>pca_y</code>: an object of class <code>pca_mfd</code>
obtained by doing MFPCA on the functional response,</p>
<p>* <code>pca_res</code>: an object of class <code>pca_mfd</code>
obtained by doing MFPCA on the functional residuals,</p>
<p>* <code>components_x</code>: a vector of integers
with the components selected in the <code>pca_x</code> model,</p>
<p>* <code>components_y</code>: a vector of integers
with the components selected in the <code>pca_y</code> model,</p>
<p>* <code>components_res</code>: a vector of integers
with the components selected in the <code>pca_res</code> model,</p>
<p>* <code>y_standardized</code>: the standardized functional response
obtained doing <code><a href='scale_mfd.html'>scale_mfd(mfdobj_y)</a></code>,</p>
<p>* <code>tot_variance_explained_x</code>: the same as the provided argument</p>
<p>* <code>tot_variance_explained_y</code>: the same as the provided argument</p>
<p>* <code>tot_variance_explained_res</code>: the same as the provided argument</p>
<p>* <code>get_studentized_residuals</code>: a function that allows
to calculate studentized residuals on new data,
given the estimated function-on-function linear regression model.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Centofanti F, Lepore A, Menafoglio A, Palumbo B, Vantini S. (2020)
Functional Regression Control Chart.
<em>Technometrics</em>. &lt;doi:10.1080/00401706.2020.1753581&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/unina-sfere/funcharts'>funcharts</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"air"</span><span class='op'>)</span>
<span class='va'>air</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>air</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>fun_covariates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>air</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>air</span><span class='op'>)</span> <span class='op'>!=</span> <span class='st'>"NO2"</span><span class='op'>]</span>
<span class='va'>mfdobj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_mfd_list.html'>get_mfd_list</a></span><span class='op'>(</span><span class='va'>air</span>, lambda <span class='op'>=</span> <span class='fl'>1e-2</span><span class='op'>)</span>
<span class='va'>mfdobj_y</span> <span class='op'>&lt;-</span> <span class='va'>mfdobj</span><span class='op'>[</span>, <span class='st'>"NO2"</span><span class='op'>]</span>
<span class='va'>mfdobj_x</span> <span class='op'>&lt;-</span> <span class='va'>mfdobj</span><span class='op'>[</span>, <span class='va'>fun_covariates</span><span class='op'>]</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'>fof_pc</span><span class='op'>(</span><span class='va'>mfdobj_y</span>, <span class='va'>mfdobj_x</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christian Capezza, Fabio Centofanti, Antonio Lepore, Alessandra Menafoglio, Biagio Palumbo, Simone Vantini.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


