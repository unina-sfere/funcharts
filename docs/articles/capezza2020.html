<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>capezza2020 • funcharts</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="capezza2020">
<meta property="og:description" content="funcharts">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funcharts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/capezza2020.html">capezza2020</a>
    </li>
    <li>
      <a href="../articles/centofanti2020.html">centofanti2020</a>
    </li>
    <li>
      <a href="../articles/mfd.html">mfd</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/unina-sfere/funcharts/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="capezza2020_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>capezza2020</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/unina-sfere/funcharts/blob/master/vignettes/capezza2020.Rmd"><code>vignettes/capezza2020.Rmd</code></a></small>
      <div class="hidden name"><code>capezza2020.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<div id="control-charts-for-monitoring-a-scalar-response-variable-and-multivariate-functional-covariates-based-on-scalar-on-function-regression" class="section level1">
<h1 class="hasAnchor">
<a href="#control-charts-for-monitoring-a-scalar-response-variable-and-multivariate-functional-covariates-based-on-scalar-on-function-regression" class="anchor"></a>Control charts for monitoring a scalar response variable and multivariate functional covariates based on scalar-on-function regression</h1>
<p>In this vignette we show how to use the <code>funcharts</code> package to apply the methods proposed in Capezza et al. (2020) to build control charts for monitoring a scalar response variable and multivariate functional covariates based on scalar-on-function regression. Let us show how the <code>funcharts</code> package works through an example with the dataset <code>air</code>, which has been included from the R package <code>FRegSigCom</code> and is used in the paper of Qi and Luo (2019). The authors propose a function-on-function regression model of the <code>NO2</code> functional variable on all the other functional variables available in the dataset. In order to show how the package works, we consider a scalar-on-function regression model, where we take the mean of <code>NO2</code> at each observation as the scalar response and all other functions as functional covariates.</p>
<p>NOTE: since the objective of this vignette is only to illustrate how the package works, in the following we will use only 15 basis functions and a fixed smoothing parameter to reduce the computational time.</p>
<p>First of all, starting from the discrete data, let us build the multivariate functional data objects of class <code>mfd</code>, see <code><a href="../articles/mfd.html">vignette("mfd")</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/unina-sfere/funcharts">funcharts</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: fda</span>
<span class="co">#&gt; Loading required package: splines</span>
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="co">#&gt; Loading required package: fds</span>
<span class="co">#&gt; Loading required package: rainbow</span>
<span class="co">#&gt; Loading required package: MASS</span>
<span class="co">#&gt; Loading required package: pcaPP</span>
<span class="co">#&gt; Loading required package: RCurl</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'fda'</span>
<span class="co">#&gt; The following object is masked from 'package:graphics':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     matplot</span>
<span class="co">#&gt; Loading required package: dplyr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following object is masked from 'package:MASS':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     select</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"air"</span><span class="op">)</span>
<span class="va">fun_covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">air</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">air</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"NO2"</span><span class="op">]</span>
<span class="va">mfdobj_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mfd_list.html">get_mfd_list</a></span><span class="op">(</span><span class="va">air</span><span class="op">[</span><span class="va">fun_covariates</span><span class="op">]</span>,
                       grid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span>,  
                       n_basis <span class="op">=</span> <span class="fl">15</span>,
                       lambda <span class="op">=</span> <span class="fl">1e-2</span><span class="op">)</span></code></pre></div>
<p>Then, we extract the scalar response variable, i.e. the mean of <code>NO2</code> at each observation:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">air</span><span class="op">$</span><span class="va">NO2</span><span class="op">)</span></code></pre></div>
<p>In order to perform the statistical process monitoring analysis, we divide the data set into a phase I and a phase II dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rows1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span>
<span class="va">rows2</span> <span class="op">&lt;-</span> <span class="fl">301</span><span class="op">:</span><span class="fl">355</span>
<span class="va">mfdobj_x1</span> <span class="op">&lt;-</span> <span class="va">mfdobj_x</span><span class="op">[</span><span class="va">rows1</span><span class="op">]</span>
<span class="va">mfdobj_x2</span> <span class="op">&lt;-</span> <span class="va">mfdobj_x</span><span class="op">[</span><span class="va">rows2</span><span class="op">]</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">rows1</span><span class="op">]</span>
<span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">rows2</span><span class="op">]</span></code></pre></div>
<div id="scalar-on-function-regression-based-on-principal-components" class="section level2">
<h2 class="hasAnchor">
<a href="#scalar-on-function-regression-based-on-principal-components" class="anchor"></a>Scalar-on-function regression based on principal components</h2>
<p>We can build a scalar-on-function linear regression model where the response variable is a linear function of the multivariate functional principal components scores. The components to retain in the model can be selected with <code>selection</code> argument. Three alternatives are available (default is <code>variance</code>):</p>
<ul>
<li>if “variance”, the first M multivariate functional principal components are retained into the MFPCA model such that together they explain a fraction of variance greater than <code>tot_variance_explained</code>,</li>
<li>if “PRESS”, each j-th functional principal component is retained into the MFPCA model if, by adding it to the set of the first j-1 functional principal components, then the predicted residual error sum of squares (PRESS) statistic decreases, and at the same time the fraction of variance explained by that single component is greater than <code>single_min_variance_explained.</code> This criterion is used in Capezza et al. (2020).</li>
<li>if “gcv”, the criterion is equal as in the previous “PRESS” case, but the “PRESS” statistic is substituted by the generalized cross-validation (GCV) score.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sof_pc.html">sof_pc</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y1</span>, 
              mfdobj_x <span class="op">=</span> <span class="va">mfdobj_x1</span>, 
              selection <span class="op">=</span> <span class="st">"PRESS"</span>, 
              single_min_variance_explained <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></code></pre></div>
<p>As a result you get a list with the original data used for model estimation, the result of applying <code>pca_mfd</code> on the multivariate functional covariates, the estiamted regression model. It is possible to plot the estimated functional regression coefficients, which is also a multivariate functional data object of class <code>mfd</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_mfd.html">plot_mfd</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></code></pre></div>
<p><img src="capezza2020_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display:block; margin: auto"></p>
<p>Moreover bootstrap can be used to obtain uncertainty quantification:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_bootstrap_sof_pc.html">plot_bootstrap_sof_pc</a></span><span class="op">(</span><span class="va">mod</span>, nboot <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><img src="capezza2020_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display:block; margin: auto"></p>
</div>
<div id="control-charts" class="section level2">
<h2 class="hasAnchor">
<a href="#control-charts" class="anchor"></a>Control charts</h2>
<p>We can build control charts to monitor both functional covariates and the scalar response. We can either monitor the functional covariates alone (unsupervised monitoring) or the functional covariates and the scalar response together (supervised monitoring), as performed in Capezza et al. (2020).</p>
<div id="unsupervised-monitoring" class="section level3">
<h3 class="hasAnchor">
<a href="#unsupervised-monitoring" class="anchor"></a>Unsupervised monitoring</h3>
<p>The function <code>control_charts_pca</code> provides a data frame with all the information required to plot the desired control charts on multivariate functional data, based on the Hotelling’s T^2 and the squared prediction error statistics (see Capezza et al. (2020) and Centofanti et al. (2020)). Among the arguments, you can pass a <code>tuning_data</code> set, that is not used for model estimation/training, but is used only to estimate control chart limits. If this data set is not provided, control chart limits are calculated on the basis of the training data. The argument <code>newdata</code> contains the phase II data set of observations of multivariate functional covariates, that are to be monitored with the control charts. The function <code>plot_control_charts</code> returns a ggplot with the control charts.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cclist_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/control_charts_pca.html">control_charts_pca</a></span><span class="op">(</span>pca <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">pca</span>, 
                                 components <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">components</span>, 
                                 newdata <span class="op">=</span> <span class="va">mfdobj_x2</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_control_charts.html">plot_control_charts</a></span><span class="op">(</span><span class="va">cclist_pca</span><span class="op">)</span></code></pre></div>
<p><img src="capezza2020_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display:block; margin: auto"></p>
</div>
<div id="supervised-monitoring" class="section level3">
<h3 class="hasAnchor">
<a href="#supervised-monitoring" class="anchor"></a>Supervised monitoring</h3>
<p>The function <code>control_charts_sof_pc</code> provides a data frame with all the information required to plot the desired control charts. In addition to the Hotelling’s T^2 and the squared prediction error statistics obtained using <code>control_charts_pca</code> (see previous section), this function provides the scalar regression control charts, which also monitors the prediction error on the response variable. The same function <code>plot_control_charts</code> can be used to obtain ggplot with the three control charts. As for unsupervised monitoring, you can pass a <code>tuning_data</code> set (see previous section).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cclist_sof_pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/control_charts_sof_pc.html">control_charts_sof_pc</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="va">mod</span>,
                                       y_test <span class="op">=</span> <span class="va">y2</span>,
                                       mfdobj_x_test <span class="op">=</span> <span class="va">mfdobj_x2</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_control_charts.html">plot_control_charts</a></span><span class="op">(</span><span class="va">cclist_sof_pc</span><span class="op">)</span></code></pre></div>
<p><img src="capezza2020_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display:block; margin: auto"></p>
</div>
</div>
<div id="fault-detection" class="section level2">
<h2 class="hasAnchor">
<a href="#fault-detection" class="anchor"></a>Fault detection</h2>
<p>Once an out-of-control observation is identified in a control chart, one can obtain the contribution of the functional covariates to the monitoring statistics to understand which variable was possibly responsible of the anomalous observation.</p>
<p>We can get the out of control observations using <code>which_ooc</code>. In the following, we focus on the supervised monitoring.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ooc_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/which_ooc.html">which_ooc</a></span><span class="op">(</span><span class="va">cclist_sof_pc</span><span class="op">)</span>
<span class="va">ooc_index</span> 
<span class="co">#&gt; $T2</span>
<span class="co">#&gt;    n  id</span>
<span class="co">#&gt; 1  5 305</span>
<span class="co">#&gt; 2 12 312</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $spe</span>
<span class="co">#&gt;   n  id</span>
<span class="co">#&gt; 1 9 309</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $y</span>
<span class="co">#&gt;    n  id</span>
<span class="co">#&gt; 1 29 329</span>
<span class="co">#&gt; 2 52 352</span>
<span class="co">#&gt; 3 53 353</span>
<span class="co">#&gt; 4 54 354</span>
<span class="co">#&gt; 5 55 355</span></code></pre></div>
<p>From the control charts it is possible to see some phase II observations out of control. For example, let us consider observation 9. We can exploit the contribution plots using the function <code>cont_plot</code> to identify the variables responsible of the anomaly. The contributions are plotted as bar plots, against upper control limits estimated empirically on the training data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cont_plot.html">cont_plot</a></span><span class="op">(</span><span class="va">cclist_sof_pc</span>, <span class="fl">9</span><span class="op">)</span></code></pre></div>
<p><img src="capezza2020_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display:block; margin: auto"> Finally, we can also plot any multivariate functional observation against a reference data set by using the function <code>plot_mon</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_mon.html">plot_mon</a></span><span class="op">(</span><span class="va">cclist_sof_pc</span>, <span class="va">mfdobj_x1</span>, <span class="va">mfdobj_x2</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="capezza2020_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display:block; margin: auto"> This helps to understand which part of the observations were anomalous. Variables exceeding contribution plot limits are coloured in red.</p>
</div>
<div id="real-time-monitoring" class="section level2">
<h2 class="hasAnchor">
<a href="#real-time-monitoring" class="anchor"></a>Real-time monitoring</h2>
<p>In Capezza et al. (2020), we have also implemented real-time monitoring (both unsupervised and supervised). Given the domain interval <span class="math inline">\((a, b)\)</span> of the functional data, for each current domain point <span class="math inline">\(k\)</span> to be monitored, it filters the available functional data in the interval <span class="math inline">\((a,k)\)</span>. The function <code>get_mfd_list_real_time</code> gives a list of functional data objects each evolving up to the intermediate domain point <span class="math inline">\(k\)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mfd_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mfd_list_real_time.html">get_mfd_list_real_time</a></span><span class="op">(</span>
  data_list <span class="op">=</span> <span class="va">air</span><span class="op">[</span><span class="va">fun_covariates</span><span class="op">]</span>,
  grid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span>,
  n_basis <span class="op">=</span> <span class="fl">15</span>,
  lambda <span class="op">=</span> <span class="fl">1e-2</span>,
  k_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span>
<span class="va">mfd_list1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">mfd_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">rows1</span><span class="op">]</span><span class="op">)</span>
<span class="va">mfd_list2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">mfd_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">rows2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>Then, the function <code>sof_pc_real_time</code> applies the function <code>sof_pc</code> to each element in <code>mfd_list1</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sof_pc_real_time.html">sof_pc_real_time</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y1</span>, mfd_real_time_list <span class="op">=</span> <span class="va">mfd_list1</span><span class="op">)</span></code></pre></div>
<p>Then, we can use <code>control_charts_sof_pc_real_time</code> to apply <code>control_charts_sof_pc</code> to each element in <code>mod_list</code> and produce control charts for the phase II data <code>mfd_list2</code> and <code>y2</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cc_list_real_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/control_charts_sof_pc_real_time.html">control_charts_sof_pc_real_time</a></span><span class="op">(</span>
  mod_list <span class="op">=</span> <span class="va">mod_list</span>,
  y_test <span class="op">=</span> <span class="va">y2</span>,
  mfdobj_x_test <span class="op">=</span> <span class="va">mfd_list2</span>
<span class="op">)</span></code></pre></div>
<p>Finally, we can plot the real-time control charts for a single observations, giving for each <span class="math inline">\(k\)</span> the monitoring statistics calculated on the data observed in <span class="math inline">\((a, k)\)</span>. Here follows an example showing the real time control charts for a single phase II observation (id number 9).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_control_charts_real_time.html">plot_control_charts_real_time</a></span><span class="op">(</span><span class="va">cc_list_real_time</span>, id_num <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></code></pre></div>
<p><img src="capezza2020_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display:block; margin: auto"></p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<ul>
<li>Capezza C, Lepore A, Menafoglio A, Palumbo B, Vantini S. (2020) Control charts for monitoring ship operating conditions and CO2 emissions based on scalar-on-function regression. <em>Applied Stochastic Models in Business and Industry</em>, 36(3):477–500. <a href="https://doi.org/10.1002/asmb.2507" class="uri">https://doi.org/10.1002/asmb.2507</a>
</li>
<li>Qi X, Luo R. (2019). Nonlinear function-on-function additive model with multiple predictor curves. <em>Statistica Sinica</em>, 29:719–739. <a href="https://doi.org/10.5705/ss.202017.0249" class="uri">https://doi.org/10.5705/ss.202017.0249</a>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christian Capezza, Fabio Centofanti, Antonio Lepore, Alessandra Menafoglio, Biagio Palumbo, Simone Vantini.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
