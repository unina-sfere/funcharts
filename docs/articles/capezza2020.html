<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>capezza2020 • funcharts</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="capezza2020">
<meta property="og:description" content="funcharts">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funcharts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/capezza2020.html">capezza2020</a>
    </li>
    <li>
      <a href="../articles/centofanti2021.html">centofanti2021</a>
    </li>
    <li>
      <a href="../articles/colosimo2010.html">colosimo2010</a>
    </li>
    <li>
      <a href="../articles/mfd.html">mfd</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/unina-sfere/funcharts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>capezza2020</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/unina-sfere/funcharts/blob/HEAD/vignettes/capezza2020.Rmd" class="external-link"><code>vignettes/capezza2020.Rmd</code></a></small>
      <div class="hidden name"><code>capezza2020.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<div class="section level2">
<h2 id="control-charts-for-monitoring-a-scalar-quality-characteristic-adjusted-for-by-the-effect-of-functional-covariates">Control charts for monitoring a scalar quality characteristic
adjusted for by the effect of functional covariates<a class="anchor" aria-label="anchor" href="#control-charts-for-monitoring-a-scalar-quality-characteristic-adjusted-for-by-the-effect-of-functional-covariates"></a>
</h2>
<p>In this vignette we show how to use the <code>funcharts</code>
package to apply the methods proposed in Capezza et al. (2020) to build
control charts for monitoring scalar quality characteristic adjusted for
by the effect of functional covariates, based on scalar-on-function
regression. Let us show how the <code>funcharts</code> package works
through an example with the dataset <code>air</code>, which has been
included from the R package <code>FRegSigCom</code> and is used in the
paper of Qi and Luo (2019). The authors propose a function-on-function
regression model of the <code>NO2</code> functional variable on all the
other functional variables available in the dataset. In order to show
how the package works, we consider a scalar-on-function regression
model, where we take the mean of <code>NO2</code> at each observation as
the scalar response and all other functions as functional
covariates.</p>
<p>First of all, starting from the discrete data, let us build the
multivariate functional data objects of class <code>mfd</code>, see
<code><a href="../articles/mfd.html">vignette("mfd")</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/unina-sfere/funcharts" class="external-link">funcharts</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"air"</span><span class="op">)</span></span>
<span><span class="va">fun_covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">air</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">air</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"NO2"</span><span class="op">]</span></span>
<span><span class="va">mfdobj_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mfd_list.html">get_mfd_list</a></span><span class="op">(</span><span class="va">air</span><span class="op">[</span><span class="va">fun_covariates</span><span class="op">]</span>, grid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span></span></code></pre></div>
<p>Then, we extract the scalar response variable, i.e. the mean of
<code>NO2</code> at each observation:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">air</span><span class="op">$</span><span class="va">NO2</span><span class="op">)</span></span></code></pre></div>
<p>In order to perform the statistical process monitoring analysis, we
divide the data set into a phase I and a phase II dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rows1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span></span>
<span><span class="va">rows2</span> <span class="op">&lt;-</span> <span class="fl">301</span><span class="op">:</span><span class="fl">355</span></span>
<span><span class="va">mfdobj_x1</span> <span class="op">&lt;-</span> <span class="va">mfdobj_x</span><span class="op">[</span><span class="va">rows1</span><span class="op">]</span></span>
<span><span class="va">mfdobj_x2</span> <span class="op">&lt;-</span> <span class="va">mfdobj_x</span><span class="op">[</span><span class="va">rows2</span><span class="op">]</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">rows1</span><span class="op">]</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">rows2</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="scalar-on-function-regression">Scalar-on-function regression<a class="anchor" aria-label="anchor" href="#scalar-on-function-regression"></a>
</h3>
<p>We can build a scalar-on-function linear regression model where the
response variable is a linear function of the multivariate functional
principal components scores. The principal components to retain in the
model can be selected with <code>selection</code> argument. Three
alternatives are available (default is <code>variance</code>):</p>
<ul>
<li>if “variance” (default), the first M multivariate functional
principal components are retained into the MFPCA model such that
together they explain a fraction of variance greater than
<code>tot_variance_explained</code>,</li>
<li>if “PRESS”, each j-th functional principal component is retained
into the MFPCA model if, by adding it to the set of the first j-1
functional principal components, then the predicted residual error sum
of squares (PRESS) statistic decreases, and at the same time the
fraction of variance explained by that single component is greater than
<code>single_min_variance_explained.</code> This criterion is used in
Capezza et al. (2020).</li>
<li>if “gcv”, the criterion is equal as in the previous “PRESS” case,
but the “PRESS” statistic is substituted by the generalized
cross-validation (GCV) score.</li>
</ul>
<p>Here, we use default values:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sof_pc.html">sof_pc</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y1</span>, mfdobj_x <span class="op">=</span> <span class="va">mfdobj_x1</span><span class="op">)</span></span></code></pre></div>
<p>As a result you get a list with several arguments, among which the
original data used for model estimation, the result of applying
<code>pca_mfd</code> on the multivariate functional covariates, the
estimated regression model. It is possible to plot the estimated
functional regression coefficients, which is also a multivariate
functional data object of class <code>mfd</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfd.html">plot_mfd</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span></code></pre></div>
<p><img src="capezza2020-plot_beta-1.png" alt="plot of chunk plot_beta" style="display:block; margin: auto"></p>
<p>Moreover bootstrap can be used to obtain uncertainty
quantification:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bootstrap_sof_pc.html">plot_bootstrap_sof_pc</a></span><span class="op">(</span><span class="va">mod</span>, nboot <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="capezza2020-plot_bootstrap_sof_pc-1.png" alt="plot of chunk plot_bootstrap_sof_pc" style="display:block; margin: auto"></p>
</div>
<div class="section level3">
<h3 id="control-charts">Control charts<a class="anchor" aria-label="anchor" href="#control-charts"></a>
</h3>
<p>We can build the regression control chart to monitor the scalar
response, as performed in Capezza et al. (2020). The function
<code>regr_cc_sof</code> provides a data frame with all the information
required to plot the desired control charts. Among the arguments, you
can pass the arguments <code>y_tuning</code> and
<code>mfdobj_x_tuning</code> set, that are not used for model
estimation/training, but only to estimate control chart limits. If these
arguments are not provided, control chart limits are calculated on the
basis of the training data. The arguments <code>y_new</code> and
<code>mfdobj_x_new</code> contain the phase II data set of observations
of the scalar response and the functional covariates to be monitored,
respectively. The function <code>plot_control_charts</code> returns the
plot of the control charts.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cclist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regr_cc_sof.html">regr_cc_sof</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                      y_new <span class="op">=</span> <span class="va">y2</span>,</span>
<span>                      mfdobj_x_new <span class="op">=</span> <span class="va">mfdobj_x2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_control_charts.html">plot_control_charts</a></span><span class="op">(</span><span class="va">cclist</span><span class="op">)</span></span></code></pre></div>
<p><img src="capezza2020-plot_control_charts_sof_pc-1.png" alt="plot of chunk plot_control_charts_sof_pc" style="display:block; margin: auto"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Capezza C, Lepore A, Menafoglio A, Palumbo B, Vantini S. (2020)
Control charts for monitoring ship operating conditions and CO2
emissions based on scalar-on-function regression. <em>Applied Stochastic
Models in Business and Industry</em>, 36(3):477–500. <a href="https://doi.org/10.1002/asmb.2507" class="external-link uri">https://doi.org/10.1002/asmb.2507</a>
</li>
<li>Qi X, Luo R. (2019). Nonlinear function-on-function additive model
with multiple predictor curves. <em>Statistica Sinica</em>, 29:719–739.
<a href="https://doi.org/10.5705/ss.202017.0249" class="external-link uri">https://doi.org/10.5705/ss.202017.0249</a>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christian Capezza, Fabio Centofanti, Antonio Lepore, Alessandra Menafoglio, Biagio Palumbo, Simone Vantini.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
