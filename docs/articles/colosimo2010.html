<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>colosimo2010 • funcharts</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="colosimo2010">
<meta property="og:description" content="funcharts">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funcharts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/capezza2020.html">capezza2020</a>
    </li>
    <li>
      <a href="../articles/centofanti2021.html">centofanti2021</a>
    </li>
    <li>
      <a href="../articles/colosimo2010.html">colosimo2010</a>
    </li>
    <li>
      <a href="../articles/mfd.html">mfd</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/unina-sfere/funcharts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>colosimo2010</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/unina-sfere/funcharts/blob/HEAD/vignettes/colosimo2010.Rmd" class="external-link"><code>vignettes/colosimo2010.Rmd</code></a></small>
      <div class="hidden name"><code>colosimo2010.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<div class="section level2">
<h2 id="functional-control-charts-for-multivariate-quality-characteristics">Functional control charts for multivariate quality
characteristics<a class="anchor" aria-label="anchor" href="#functional-control-charts-for-multivariate-quality-characteristics"></a>
</h2>
<p>In this vignette we show how to use the <code>funcharts</code>
package to apply the methods proposed in Colosimo and Pacella et
al. (2010) to build control charts for monitoring a multivariate
functional quality characteristic. Let us show how the
<code>funcharts</code> package works through an example with the dataset
<code>air</code>.</p>
<p>First of all, starting from the discrete data, let us build the
multivariate functional data objects of class <code>mfd</code>, see
<code><a href="../articles/mfd.html">vignette("mfd")</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/unina-sfere/funcharts" class="external-link">funcharts</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"air"</span><span class="op">)</span></span>
<span><span class="va">mfdobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mfd_list.html">get_mfd_list</a></span><span class="op">(</span><span class="va">air</span>, grid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">nobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mfdobj</span><span class="op">$</span><span class="va">coefs</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">nobs</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 355</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfd.html">plot_mfd</a></span><span class="op">(</span><span class="va">mfdobj</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-1-1.png" alt=""><p class="caption">plot of chunk unnamed-chunk-1</p>
</div>
<p>In order to perform the statistical process monitoring analysis, we
divide the data set into a phase I and a phase II dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rows1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span></span>
<span><span class="va">rows2</span> <span class="op">&lt;-</span> <span class="fl">301</span><span class="op">:</span><span class="fl">355</span></span>
<span><span class="va">mfdobj1</span> <span class="op">&lt;-</span> <span class="va">mfdobj</span><span class="op">[</span><span class="va">rows1</span><span class="op">]</span></span>
<span><span class="va">mfdobj2</span> <span class="op">&lt;-</span> <span class="va">mfdobj</span><span class="op">[</span><span class="va">rows2</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="multivariate-functional-principal-component-analysis">Multivariate functional principal component analysis<a class="anchor" aria-label="anchor" href="#multivariate-functional-principal-component-analysis"></a>
</h3>
<p>For class <code>mfd</code> we provide a function
<code>pca_mfd</code>, which is a wrapper to <code>pca.fd</code>. It
returns multivariate functional principal component scores summed over
variables (<code><a href="https://rdrr.io/pkg/fda/man/pca.fd.html" class="external-link">fda::pca.fd</a></code> returns an array of scores when
providing a multivariate functional data object). Moreover, the
eigenfunctions or multivariate functional principal components given in
<code>harmonics</code> argument are converted to the <code>mfd</code>
class. We also provide a plot function for the eigenfunctions (the
argument <code>harm</code> selects which components to plot).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pca_mfd.html">pca_mfd</a></span><span class="op">(</span><span class="va">mfdobj1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_pca_mfd.html">plot_pca_mfd</a></span><span class="op">(</span><span class="va">pca</span>, harm <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-3-1.png" alt=""><p class="caption">plot of chunk unnamed-chunk-3</p>
</div>
</div>
<div class="section level3">
<h3 id="control-charts">Control charts<a class="anchor" aria-label="anchor" href="#control-charts"></a>
</h3>
<p>The function <code>control_charts_pca</code> provides a data frame
with all the information required to plot the desired control charts on
multivariate functional data, based on the Hotelling’s <span class="math inline">\(T^2\)</span> and the squared prediction error
statistics (see Colosimo and Pacella (2010), Capezza et al. (2020)).
Among the arguments, you can pass a <code>tuning_data</code> set, that
is not used for model estimation/training, but only to estimate control
chart limits. If this data set is not provided, control chart limits are
calculated on the basis of the training data. The argument
<code>newdata</code> contains the phase II data set of observations of
multivariate functional covariates to be monitored. The function
<code>plot_control_charts</code> returns the plot of the control
charts.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cclist_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/control_charts_pca.html">control_charts_pca</a></span><span class="op">(</span>pca <span class="op">=</span> <span class="va">pca</span>, newdata <span class="op">=</span> <span class="va">mfdobj2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_control_charts.html">plot_control_charts</a></span><span class="op">(</span><span class="va">cclist_pca</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/plot_control_charts_pca-1.png" alt=""><p class="caption">plot of chunk plot_control_charts_pca</p>
</div>
</div>
<div class="section level3">
<h3 id="fault-detection">Fault detection<a class="anchor" aria-label="anchor" href="#fault-detection"></a>
</h3>
<p>Once an out-of-control observation is identified in a control chart,
one can obtain the contribution of the functional covariates to the
monitoring statistics to understand which variable was possibly
responsible of the anomalous observation.</p>
<p>We can get the out of control observations using
<code>which_ooc</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ooc_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/which_ooc.html">which_ooc</a></span><span class="op">(</span><span class="va">cclist_pca</span><span class="op">)</span></span>
<span><span class="va">ooc_index</span></span></code></pre></div>
<pre><code><span><span class="co">## $T2</span></span>
<span><span class="co">##    n  id</span></span>
<span><span class="co">## 1  2 302</span></span>
<span><span class="co">## 2  5 305</span></span>
<span><span class="co">## 3  9 309</span></span>
<span><span class="co">## 4 12 312</span></span>
<span><span class="co">## 5 23 323</span></span>
<span><span class="co">## 6 32 332</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $spe</span></span>
<span><span class="co">##    n  id</span></span>
<span><span class="co">## 1  9 309</span></span>
<span><span class="co">## 2 25 325</span></span>
<span><span class="co">## 3 28 328</span></span>
<span><span class="co">## 4 34 334</span></span>
<span><span class="co">## 5 48 348</span></span>
<span><span class="co">## 6 52 352</span></span>
<span><span class="co">## 7 54 354</span></span>
<span><span class="co">## 8 55 355</span></span></code></pre>
<p>From the control charts it is possible to see some phase II
observations out of control. For example, let us consider observation 9.
We can exploit the contribution plots using the function
<code>cont_plot</code> to identify the variables responsible of the
anomaly. The contributions are plotted as bar plots, against upper
control limits estimated empirically on the training data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cont_plot.html">cont_plot</a></span><span class="op">(</span><span class="va">cclist_pca</span>, <span class="fl">9</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/cont_plot-1.png" alt="plot of chunk cont_plot">
Finally, we can also plot any multivariate functional observation
against a reference data set by using the function
<code>plot_mon</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mon.html">plot_mon</a></span><span class="op">(</span><span class="va">cclist_pca</span>, fd_train <span class="op">=</span> <span class="va">mfdobj1</span>, fd_test <span class="op">=</span> <span class="va">mfdobj2</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/plot_mon-1.png" alt="plot of chunk plot_mon"> This
helps to understand which profiles were anomalous. Variables exceeding
contribution plot limits are coloured in red.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Colosimo, BM Pacella, M. (2010) A comparison study of control charts
for statistical monitoring of functional data. <em>International Journal
of Production Research</em>, 48(6), 1575-1601. <a href="https://doi.org/10.1080/00207540802662888" class="external-link uri">https://doi.org/10.1080/00207540802662888</a>
</li>
<li>Capezza C, Lepore A, Menafoglio A, Palumbo B, Vantini S. (2020)
Control charts for monitoring ship operating conditions and CO2
emissions based on scalar-on-function regression. <em>Applied Stochastic
Models in Business and Industry</em>, 36(3):477–500. <a href="https://doi.org/10.1002/asmb.2507" class="external-link uri">https://doi.org/10.1002/asmb.2507</a>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christian Capezza, Fabio Centofanti, Antonio Lepore, Alessandra Menafoglio, Biagio Palumbo, Simone Vantini.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
